<!DOCTYPE html>
<html lang="km">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>កម្មវិធីគ្រប់គ្រងគ្រឿងឡាន</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>កម្មវិធីគ្រប់គ្រងគ្រឿងឡាន 🚗</h1>
        </div>
        <div class="tabs">
            <button class="tab active" onclick="switchTab('add')">បន្ថែមគ្រឿង</button>
            <button class="tab" onclick="switchTab('stock')">ស្តុកគ្រឿង</button>
            <button class="tab" onclick="switchTab('stats')">ស្ថិតិ</button>
        </div>
        <div id="add-tab" class="tab-content active">
            <div class="form-card">
                <form onsubmit="saveItem(event)">
                    <label for="company">ក្រុមហ៊ុន</label>
                    <input id="company" required>
                    <label for="productCode">កូដគ្រឿង</label>
                    <input id="productCode" required>
                    <label for="partName">ឈ្មោះគ្រឿង</label>
                    <input id="partName" required>
                    <label for="carModel">ប្រភេទ</label>
                    <input id="carModel" required>
                    <label for="modelYear">ឆ្នាំម៉ូដែល</label>
                    <input id="modelYear" required>
                    <label for="buyPrice">តម្លៃទិញ ($)</label>
                    <input id="buyPrice" type="number" step="0.01" required>
                    <label for="sellPrice">តម្លៃលក់ ($)</label>
                    <input id="sellPrice" type="number" step="0.01" required>
                    <label for="productImage">រូបភាពគ្រឿង</label>
                    <input id="productImage" type="file" accept="image/*">
                    <button type="submit" class="btn">រក្សាទុកគ្រឿង</button>
                </form>
            </div>
        </div>
        <div id="stock-tab" class="tab-content">
            <div class="search-box">
                <input id="searchInput" oninput="searchItems()" placeholder="ស្វែងរកដោយឈ្មោះ ប្រភេទ កូដ...">
            </div>
            <a href="#" onclick="exportToCSV()">នាំចេញជា CSV 📄</a>
            <table>
                <thead>
                    <tr>
                        <th>ល.រ</th>
                        <th>ឈ្មោះគ្រឿង</th>
                        <th>ប្រភេទ</th>
                        <th>ម៉ូដែលឡាន</th>
                        <th>ឆ្នាំម៉ូដែល</th>
                        <th>តម្លៃទិញ ($)</th>
                        <th>តម្លៃលក់ ($)</th>
                        <th>តម្លៃសរុប ($)</th>
                        <th>សកម្មភាព</th>
                    </tr>
                </thead>
                <tbody id="stockTableBody"></tbody>
            </table>
        </div>
        <div id="stats-tab" class="tab-content">
            <div class="stats-grid">
                <div class="stat-card">
                    <h5>ទំនិញសរុប</h5>
                    <div class="stat-value" id="totalItems">0</div>
                </div>
                <div class="stat-card">
                    <h5>តម្លៃសរុប ($)</h5>
                    <div class="stat-value" id="totalValue">0.00</div>
                </div>
                <div class="stat-card">
                    <h5>ប្រាក់ចំណេញសរុប ($)</h5>
                    <div class="stat-value" id="totalProfit">0.00</div>
                </div>
                <div class="stat-card">
                    <h5>គ្រឿងស្តុកទាប</h5>
                    <div class="stat-value" id="lowStock">0</div>
                </div>
            </div>
        </div>
        <label class="theme-toggle">
            <input type="checkbox" id="darkModeToggle" onchange="toggleDarkMode()">
            <span>របៀបងងឹត</span>
        </label>
    </div>
    <div id="duplicateModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>កូដគ្រឿង <span id="duplicateCode"></span> មានរួចហើយ!</h2>
                <button class="close-btn" onclick="closeDuplicateModal()">&times;</button>
            </div>
            <p>តើអ្នកចង់បន្ថែមជាទំនិញថ្មី ឬកែប្រែទំនិញចាស់?</p>
            <div class="modal-buttons">
                <button class="modal-btn-add" onclick="addAsNew()">បន្ថែមថ្មី</button>
                <button class="modal-btn-edit" onclick="editExisting()">កែប្រែចាស់</button>
                <button class="modal-btn-cancel" onclick="closeDuplicateModal()">បោះបង់</button>
            </div>
        </div>
    </div>
    <div id="editModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>កែប្រែគ្រឿង</h2>
                <button class="close-btn" onclick="closeModal()">&times;</button>
            </div>
            <form onsubmit="updateItem(event)">
                <input type="hidden" id="editId">
                <label for="editCompany">ក្រុមហ៊ុន</label>
                <input id="editCompany" required>
                <label for="editProductCode">កូដគ្រឿង</label>
                <input id="editProductCode" required>
                <label for="editPartName">ឈ្មោះគ្រឿង</label>
                <input id="editPartName" required>
                <label for="editCarModel">ប្រភេទ</label>
                <input id="editCarModel" required>
                <label for="editModelYear">ឆ្នាំម៉ូដែល</label>
                <input id="editModelYear" required>
                <label for="editBuyPrice">តម្លៃទិញ ($)</label>
                <input id="editBuyPrice" type="number" step="0.01" required>
                <label for="editSellPrice">តម្លៃលក់ ($)</label>
                <input id="editSellPrice" type="number" step="0.01" required>
                <button type="submit" class="btn">រក្សាទុក</button>
            </form>
        </div>
    </div>
    <script src="script.js"></script>
</body>
</html>